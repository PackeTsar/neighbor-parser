(()=>{var t={868:t=>{function e(t,e){const n=new RegExp(t).exec(e);return n?n[2]:null}function n(t,e,n){const o=t.exec(n);return o?o[e]:null}function o(t){return e(/(Interface: *)([^\s,]+),?/,t)}function s(t){return n(/(Local (Intf|Port id): *)(.*)/,3,t)}function r(t){return e("(Device ID: *)(.*)",t)}function a(t){return e("(System Name: *)(.*)",t)}function i(t){return e("(Port ID \\(outgoing port\\): *)(.*)",t)}function l(t){return e("(Port Description: *)(.*)",t)}function c(t){return null}function u(t){return e("(Port id: *)(.*)",t)}function d(t){return e("(Platform: *)(.*),",t)}function p(t){return null}function f(t){return n(/Version *:\n(.*?)(?=\n\n)/s,1,t)}function m(t){return t.match(/System Description:[\s]*\n/)?n(/System Description:[\s]*\n(.*?)(?=\n\n)/s,1,t):e("(System Description: )(.*)",t)}function h(t){return e("(Holdtime *: )(.*)",t)}function g(t){return e("(Time remaining: )(.*)",t)}function I(t){return null}function b(t){return e("(Chassis id: )(.*)",t)}function y(t){return e("(Capabilities: )(.*)",t)}function v(t){return e("(System Capabilities: )(.*)",t)}function x(t,e){if(t){const n=[];for(const o of t)n.push(o[e]);return[...new Set(n)]}return[]}function S(t){return x(t.matchAll(/(IP|IPv4|IPv6) (A|a)ddress: ([0-9a-fA-F:]\S*)/gm),3)}function $(t){return x(t.matchAll(/((Management Address|IP|IPV6): )([0-9a-fA-F:]\S*)/gm),3)}const w={CDP:{localIntf:o,sysName:r,remoteIntf:i,remoteIntfId:c,platform:d,description:f,ttl:h,sysId:I,sysCap:y,addresses:S},LLDP:{localIntf:s,sysName:a,remoteIntf:l,remoteIntfId:u,platform:p,description:m,ttl:g,sysId:b,sysCap:v,addresses:$}};t.exports={cdpLocalIntf:o,lldpLocalIntf:s,cdpSysName:r,lldpSysName:a,cdpRemoteIntf:i,lldpRemoteIntf:l,cdpRemoteIntfId:c,lldpRemoteIntfId:u,cdpPlatform:d,lldpPlatform:p,cdpDescription:f,lldpDescription:m,cdpTtl:h,lldpTtl:g,cdpSysId:I,lldpSysId:b,cdpSysCap:y,lldpSysCap:v,cdpAddresses:S,lldpAddresses:$,funcMap:w}},506:t=>{t.exports={NEIGHBORS:[{num:"1",type:"CDP",localIntf:"GigabitEthernet1/0/1",localIntfShort:"Gi1/0/1",sysName:"WAP1",remoteIntf:"GigabitEthernet0",remoteIntfShort:"Gi0",remoteIntfId:null,platform:"AIR-AP3802I-B-K9",description:"Cisco AP Software, ap3g3-k9w8 Version: 8.10.151.0",ttl:"100 sec",sysId:null,sysCap:null,addresses:["10.10.10.11","FE80::11"]},{num:"2",type:"LLDP",localIntf:"Gi1/0/2",localIntfShort:"Gi1/0/2",sysName:"WAP2",remoteIntf:"eth0",remoteIntfShort:"eth0",remoteIntfId:"0",platform:null,description:"Cisco AP Software, ap3g3-k9w8 Version: 8.10.151.0",ttl:"100 seconds",sysId:"0000.0000.0002",sysCap:"B",addresses:["10.10.10.12","FE80::12"]}]}},508:(t,e,n)=>{const o=n(127);joint.shapes.standard.Rectangle.define("shapes.Device",{attrs:{".":{"data-bs-title":"My Shape","data-bs-placement":"top","data-bs-toggle":"diagram-tooltip","data-bs-html":"true"}}},{},{}),t.exports={makePaper:function(t){const e=joint.shapes,n=new joint.dia.Graph({},{cellNamespace:e}),s=new joint.dia.Paper({el:document.getElementById("diagram"),model:n,width:"100%",height:250,gridSize:1,drawGrid:!0,cellViewNamespace:e,restrictTranslate:!0,snapLabels:!0,interactive:{linkMove:!1,labelMove:!0,arrowheadMove:!1,vertexMove:!1,vertexAdd:!1,vertexRemove:!1,useLinkTools:!1}});let r=null;s.on("blank:pointerdown",(function(t,e,n){const o=s.scale();r={x:e*o.sx,y:n*o.sy}})),s.on("cell:pointerup blank:pointerup",(function(t,e,n){r=null})),$("#diagram").on("mousemove touchmove",(function(t){if(null!=r){let e="svg";if("touchmove"===t.type){const n=t.touches[0]||t.changedTouches[0],o=document.elementFromPoint(n.clientX,n.clientY);o?(e=o.tagName,t.offsetX=n.clientX-o.getBoundingClientRect().x,t.offsetY=n.clientY-o.getBoundingClientRect().y):e=null}"svg"===e&&s.translate(t.offsetX-r.x,t.offsetY-r.y)}}));const a=_.partial(o.adjustVertices,n);return n.on("add remove change:source change:target",a),s.on("cell:pointerup",a),n.adjustGraphVertices=a,n.neighbors={},[n,s]},layout:function(t,e){const n=$("#rank_direction").val(),o=parseInt($("#rank_separation").html())/100,s=$("#diagram_wrapper").width()*o;joint.layout.DirectedGraph.layout(t,{marginX:10,marginY:10,rankSep:s,rankDir:n}),e.fitToContent(),e.setDimensions("100%",e.options.height+50);const r=e.getArea(),a=e.getContentArea();e.translate((r.width-a.width)/2,(r.height-a.height)/2);const i=t.getConnectedLinks(t.selfNeighbor,{outbound:!0}),l=parseInt($("#local_label").html())/100,c=parseInt($("#remote_label").html())/100;i.forEach((e=>{for(let t=0;t<e.labels().length;t++){let n=.5;n="local"===e.label(t).device?l:c,e.label(t,{position:{distance:n}})}t.adjustGraphVertices(e)}))},drawSelfNeighbor:function(t){const e=new joint.shapes.standard.Circle;return e.resize(50,50),e.attr({body:{fill:"Gray"}}),e.addTo(t),t.selfNeighbor=e,e},drawNeighbor:function(t,e,n){let o;if(n.sysName in t.neighbors)o=t.neighbors[n.sysName];else{let e="red";n.type.includes("CDP")?e="#0d6efd":n.type.includes("LLDP")&&(e="#198754"),o=new joint.shapes.shapes.Device,o.position(100,30),o.resize(100,40);const s={text:"null"!==n.sysName?n.sysName:n.sysId,fill:"white",fontSize:14};o.attr({body:{fill:e,rx:10},label:s}),o.attr("./data-bs-title",function(t){const e=[];return t.type&&e.push(`<b>Type:</b> ${t.type}`),t.sysId&&e.push(`<b>System ID:</b> ${t.sysId}`),t.platform&&e.push(`<b>Platform:</b> ${t.platform}`),t.addresses.length&&e.push(`<b>Addresses:</b> ${t.addresses.join(", ")}`),t.sysCap&&e.push(`<b>Capabilities:</b> ${t.sysCap}`),t.description&&e.push(`<b>Description:</b> ${t.description}`),`<p>${e.join("<br>")}</p>`}(n));const r=function(t){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(e);const n=V("text").attr({fontSize:t.fontSize}).text(t.text);n.appendTo(e);const o=n.getBBox();return n.remove(),e.remove(),o.width<25?25:o.width}(o.attributes.attrs.label);o.attributes.size.width=r,t.neighbors[n.sysName]=o}const s=new joint.shapes.standard.Link;return s.attr({line:{sourceMarker:{d:""},targetMarker:{d:""}}}),s.appendLabel({attrs:{text:{text:n.localIntfShort}},position:{distance:.65},device:"local"}),s.appendLabel({attrs:{text:{text:"null"!==n.remoteIntfShort?n.remoteIntfShort:n.remoteIntfId}},position:{distance:.85},device:"remote"}),s.source(e),s.target(o),s.connector("smooth"),o.addTo(t),s.addTo(t),o}}},127:t=>{t.exports={adjustVertices:function t(e,n){if((n=n.model||n)instanceof joint.dia.Element)return void _.chain(e.getConnectedLinks(n)).groupBy((function(t){return _.omit([t.source().id,t.target().id],n.id)[0]})).each((function(n,o){"undefined"!==o&&t(e,_.first(n))})).value();const o=n.get("source").id||n.previous("source").id,s=n.get("target").id||n.previous("target").id;if(!o||!s)return;const r=_.filter(e.getLinks(),(function(t){const e=t.source().id,n=t.target().id;return e===o&&n===s||e===s&&n===o})),a=r.length;switch(a){case 0:break;case 1:n.unset("vertices");break;default:{const t=e.getCell(o).getBBox().center(),n=e.getCell(s).getBBox().center(),i=g.Line(t,n).midpoint(),l=t.theta(n),c=parseInt($("#sibling_gap").html());_.each(r,(function(t,e){let n=c*Math.ceil(e/2);const o=e%2?1:-1;a%2==0&&(n-=c/2*o);const s=l<180?1:-1,r=g.toRad(l+o*s*90),u=g.Point.fromPolar(n,r,i);t.vertices([u])}))}}}}},529:(t,e,n)=>{const o=n(561),s=n(868),r=n(632);function a(t){if(!t)return t;if(t.length<6)return t;const e=t.match(/^([A-Za-z ]+)/);return e?t.replace(e[0],e[0].slice(0,2)):t}t.exports={getNeighbors:function(t){let e=[];return o.cleanArray(o.splitDetect(t)).forEach((function(t){const n=t.data,o=t.type;if(o.includes("SHORT")){const t=r.funcMap[o](n);t.forEach((function(t){t.type=o,t.localIntfShort=a(t.localIntf),t.remoteIntfShort=a(t.remoteIntf)})),e=e.concat(t)}else e.push({type:o,localIntf:s.funcMap[o].localIntf(n),localIntfShort:a(s.funcMap[o].localIntf(n)),sysName:s.funcMap[o].sysName(n),remoteIntf:s.funcMap[o].remoteIntf(n),remoteIntfShort:a(s.funcMap[o].remoteIntf(n)),remoteIntfId:s.funcMap[o].remoteIntfId(n),platform:s.funcMap[o].platform(n),description:s.funcMap[o].description(n),ttl:s.funcMap[o].ttl(n),sysId:s.funcMap[o].sysId(n),sysCap:s.funcMap[o].sysCap(n),addresses:s.funcMap[o].addresses(n)})})),e},shorten:a}},632:(t,e,n)=>{const o=n(561);function s(t){let e=o.getShortBlocks(t)[0];return e=e.replace(/\n[ ]{4}/gs,""),e=e.replace(/Device( |-)ID.*?Port ID\n/gs,""),e=e.replace(/[\n]*(Total (cdp )?entries displayed|\S+(#|>)).*/gs,""),e}function r(t){const e=[];return s(t).split("\n").forEach((function(t){let n=[];const o=t.match(/^\S*/);let s=t.replace(o[0],"");const r=s.match(/^[ ]*(\S*\s\S*)/);s=s.replace(r[0],"");const a=s.match(/^[ ]*([0-9]*)/);s=s.replace(a[0],"");const i=s.match(/^[ ]*([A-Za-z] )+/g);if(i){const t=i[0];n=t.trim().split(" "),s=s.replace(t,"")}const l=s.match(/^[ ]*(\S*)/);s=s.replace(l[0],""),e.push({sysName:o[0],localIntf:r[1].trim(),ttl:a[1].trim(),sysCap:n,platform:l[1],remoteIntf:s.trim(),remoteIntfId:null,description:null,sysId:null,addresses:[]})})),e}function a(t){let e="";const n=[];if(o.getShortBlocks(t)[0].match(/\n[ ]{4}/))e=s(t);else{const n=t.match(/Device ID.*?Port ID/)[0].match(/Local/).index,o=s(t),r=[];o.split("\n").forEach((function(t){r.push(t.slice(0,n)+"    "+t.slice(n))})),e=r.join("\n")}const r=e.split("\n");let a=[];return r.forEach((function(t){const e=t.match(/^\S*/);let o=t.replace(e[0],"");const s=o.match(/^[ ]*(\S*)/);o=o.replace(s[0],"");const r=o.match(/^[ ]*([0-9]*)/);o=o.replace(r[0],"");const i=o.match(/^[ ]*([A-Za-z,]+)/);if(i){const t=i[0],e=t.trim().split("");a=e.filter((t=>","!==t)),o=o.replace(t,"")}else a=[];n.push({sysName:e[0],localIntf:s[1].trim(),ttl:r[1].trim(),sysCap:a,remoteIntf:o.trim(),remoteIntfId:null,platform:null,description:null,sysId:null,addresses:[]})})),n}const i={"CDP-SHORT":r,"LLDP-SHORT":a};t.exports={trimTable:s,cdpParseTable:r,lldpParseTable:a,funcMap:i}},561:t=>{function e(t){return t.match(/Device( |-)ID[ ]*Local Int(r)?f(ce)?[^\n]*?Port ID[ ]*\n[^\n].*?(Total (cdp )?entries displayed|\S+(#|>))/gs)}function n(t){return t.replace(/(\nDevice( |-)ID[ ]*Local Int(r)?f(ce)?)/gs,"--------$1")}function o(t){return(t=n(t)).split(/-----*|\n\n\n/)}function s(t){return e(t)?t.match(/Platform /)?"CDP-SHORT":t.match(/Local Intf /)?"LLDP-SHORT":null:t.match(/Platform:/)?"CDP":t.match(/System Name:/)?"LLDP":null}t.exports={getShortBlocks:e,insertDelineators:n,split:o,detect:s,splitDetect:function(t){return o(t).map((t=>({type:s(t),data:t})))},cleanArray:function(t){const e=[];for(let n=0;n<t.length;n++)t[n].type&&e.push(t[n]);return e}}}},e={};function n(o){var s=e[o];if(void 0!==s)return s.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}(()=>{const t=n(529),e=n(508),o=n(506);function s(n,o,s){n.clear(),n.neighbors={};const r=e.drawSelfNeighbor(n),a=$("#neighborTable").DataTable({retrieve:!0}),i=$("#neighborData");let l;a.clear().draw(),l=s||t.getNeighbors(i.val());for(let t=0;t<l.length;t++)l[t].num=t+1,a.row.add(l[t]),e.drawNeighbor(n,r,l[t]);a.draw(),e.layout(n,o),$('[data-bs-toggle="diagram-tooltip"]').tooltip()}$(document).ready((function(){const t=$("#diagram_wrapper")[0],[n,r]=e.makePaper(t);new ResizeObserver((t=>{for(const e of t)r.setDimensions(r.options.width,e.contentRect.height)})).observe(t),$("#neighborData").keyup((function(){s(n,r)})),$("#parseNeighbors").click((function(){s(n,r),$("#neighbor_search").focus()})),$("#clearNeighborData").click((function(){const t=$("#neighborData")[0];t.value="",s(n,r),t.focus()})),$(".modal-dialog").draggable({handle:".modal-header"}),$(".zoom-in").click((function(){const t=r.scale();r.scale(1.1*t.sx,1.1*t.sy),$("#current_zoom").html(Math.round(100*r.scale().sx)),$("#new_zoom").html(Math.round(100*r.scale().sx)),this.blur()})),$(".zoom-out").click((function(){const t=r.scale();r.scale(.9*t.sx,.9*t.sy),$("#current_zoom").html(Math.round(100*r.scale().sx)),$("#new_zoom").html(Math.round(100*r.scale().sx)),this.blur()})),$("#download_diagram_button").click((function(){!function(t,e){let n=(new XMLSerializer).serializeToString(t);n=n.replace(/data-bs-title=".*?"/gm,"");const o="data:image/svg+xml;base64,"+window.btoa(n);document.createElement("img").src=o;const s=document.createElement("a");s.href=o,s.download="Neighbor_Parser.svg",document.body.appendChild(s),s.click(),document.body.removeChild(s)}(r.svg)}));const a=$("#new_zoom");$(".zoom-in-stage").click((function(){a.html(Math.round(1.1*a.html())),this.blur()})),$(".zoom-out-stage").click((function(){a.html(Math.round(.9*a.html())),this.blur()})),$(".zoom-reset-current-stage").click((function(){a.html($("#current_zoom").html()),this.blur()})),$(".zoom-reset-100-stage").click((function(){a.html("100"),this.blur()})),$(".zoom-reset").click((function(){r.scale(1,1),$("#current_zoom").html(Math.round(100*r.scale().sx)),this.blur()})),$("#apply_diagram_settings").click((function(){r.scale(parseInt(a.html())/100,parseInt(a.html())/100),$("#current_zoom").html(Math.round(100*r.scale().sx)),e.layout(n,r)}));const i=$("#rank_separation");$("#rank_separation_slider").slider({min:0,max:100,value:65,slide:function(t,e){i.text(e.value)},create:function(){i.text($(this).slider("value"))}});const l=$("#local_label"),c=$("#remote_label");l.on("mousedown",(function(){this.style.zIndex="11",c[0].style.zIndex="10"})),c.on("mousedown",(function(){this.style.zIndex="11",l[0].style.zIndex="10"})),$("#label_positions_slider").slider({range:!0,min:0,max:100,values:[65,85],slide:function(t,e){l.text(e.values[0]),c.text(e.values[1])},create:function(){l.text($(this).slider("values")[0]),c.text($(this).slider("values")[1])}});const u=$("#sibling_gap");$("#sibling_gap_slider").slider({min:0,max:100,value:30,slide:function(t,e){u.text(e.value)},create:function(){u.text($(this).slider("value"))}}),s(n,r,o.NEIGHBORS)}))})()})();